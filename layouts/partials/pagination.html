{{ $pag := .Paginator }}
<!-- Number of links either side of the current page. -->
{{ $adjlinks := 2 }}
<!-- $max_links = ($adjlinks * 2) + 1 -->
{{ $max_links := (add (mul $adjlinks 2) 1) }}
<!-- $lower_limit = $adjlinks + 1 -->
{{ $lower_limit := (add $adjlinks 1) }}
<!-- $upper_limit = $pag.TotalPages - $adjlinks -->
{{ $upper_limit := (sub $pag.TotalPages $adjlinks) }}
<!-- Create a path prefix for the home page -->
{{ $path_prefix := "" }}
{{ if eq .Page.Type "home" }}{{ $path_prefix = "/posts" }}{{ end }}
<!-- If there's more than one page. -->
{{ if gt $pag.TotalPages 1 }}
<ul class="pagination">
  <!-- First page. -->
  {{ if ne $pag.PageNumber 1 }}
  <li class="pagination__item pagination__item--first">
    <a class="pagination__link pagination__link--first" href="{{$path_prefix}}{{ $pag.First.URL }}" title="First Page">
      <i class="fas fa-angle-double-left fa-fw"></i>
      <span class="u-vh">First Page</span>
    </a>
  </li>
  {{ end }}
  <!-- Previous page. -->
  {{ if $pag.HasPrev }}
  <li class="pagination__item pagination__item--previous">
    <a href="{{$path_prefix}}{{ $pag.Prev.URL }}" class="pagination__link pagination__link--previous"
      title="Previous Page">
      <i class="fas fa-angle-left fa-fw"></i>
      <span class="u-vh">Previous Page</span>
    </a>
  </li>
  {{ end }}
  <!-- Page numbers. -->
  {{ range $pag.Pagers }}
  {{ $.Scratch.Set "page_number_flag" false }}
  <!-- Advanced page numbers. -->
  {{ if gt $pag.TotalPages $max_links }}
  <!-- Lower limit pages. -->
  <!-- If the user is on a page which is in the lower limit.  -->
  {{ if le $pag.PageNumber $lower_limit }}
  <!-- If the current loop page is less than max_links. -->
  {{ if le .PageNumber $max_links }}
  {{ $.Scratch.Set "page_number_flag" true }}
  {{ end }}
  <!-- Upper limit pages. -->
  <!-- If the user is on a page which is in the upper limit. -->
  {{ else if ge $pag.PageNumber $upper_limit }}
  <!-- If the current loop page is greater than total pages minus $max_links -->
  {{ if gt .PageNumber (sub $pag.TotalPages $max_links) }}
  {{ $.Scratch.Set "page_number_flag" true }}
  {{ end }}
  <!-- Middle pages. -->
  {{ else }}
  {{ if and ( ge .PageNumber (sub $pag.PageNumber $adjlinks) ) ( le .PageNumber (add $pag.PageNumber $adjlinks) ) }}
  {{ $.Scratch.Set "page_number_flag" true }}
  {{ end }}
  {{ end }}
  <!-- Simple page numbers. -->
  {{ else }}
  {{ $.Scratch.Set "page_number_flag" true }}
  {{ end }}
  <!-- Output page numbers. -->
  {{ if eq ($.Scratch.Get "page_number_flag") true }}
  <li class="pagination__item{{ if eq . $pag }} pagination__item--current{{ end }}">
    <a href="{{$path_prefix}}{{ .URL }}" class="pagination__link" title="Page {{ .PageNumber }}">{{ .PageNumber }}</a>
  </li>
  {{ end }}
  {{ end }}
  <!-- Next page. -->
  {{ if $pag.HasNext }}
  <li class="pagination__item pagination__item--next">
    <a href="{{$path_prefix}}{{ $pag.Next.URL }}" class="pagination__link pagination__link--next" title="Next Page">
      <i class="fas fa-angle-right fa-fw"></i>
      <span class="u-vh">Next Page</span>
    </a>
  </li>
  {{ end }}
  <!-- Last page. -->
  {{ if ne $pag.PageNumber $pag.TotalPages }}
  <li class="pagination__item pagination__item--last">
    <a class="pagination__link pagination__link--last" href="{{$path_prefix}}{{ $pag.Last.URL }}" title="Last Page">
      <i class="fas fa-angle-double-right fa-fw"></i>
      <span class="u-vh">Last Page</span>
    </a>
  </li>
  {{ end }}
</ul>
{{ end }}
