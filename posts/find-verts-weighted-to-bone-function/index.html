<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="generator" content="Hugo 0.18.1" />

  <title>PEPETD</title>
  
  <link rel="canonical" href="https://kstdnr.github.io/posts/find-verts-weighted-to-bone-function/" />
  <link rel="stylesheet" href="https://kstdnr.github.io/assets/main.bundle.css" />
</head>
<body>
  <div class="Header" role="banner">
    <div class="layout-widthDefault">
      <div class="SiteNav u-mt8">
  <ul class="SiteNav-links" role="navigation" aria-label="site navigation">
    
      <li class="SiteNav-item">
        <a class="SiteNav-link" href="/" title="Blog">Blog</a>
      </li>
    
      <li class="SiteNav-item">
        <a class="SiteNav-link" href="/projects" title="Projects">Projects</a>
      </li>
    
      <li class="SiteNav-item">
        <a class="SiteNav-link" href="/categories/development" title="Development">Development</a>
      </li>
    
      <li class="SiteNav-item">
        <a class="SiteNav-link" href="/categories/tutorials" title="Tutorials">Tutorials</a>
      </li>
    
      <li class="SiteNav-item">
        <a class="SiteNav-link" href="/demo-reel" title="Demo Reel">Demo Reel</a>
      </li>
    
      <li class="SiteNav-item">
        <a class="SiteNav-link" href="/about" title="About">About</a>
      </li>
    
  </ul>
</div>
      <div class="Header-branding u-mt8">
  
    <a class="Header-brandingText" href="https://kstdnr.github.io/" title="PEPETD">PEPETD</a> 
  
</div>
      <div class="SocialNav">
  <ul class="SocialNav-links" role="navigation" aria-label="social navigation">
    
      <li class="SocialNav-item">
        <a class="SocialNav-link" href="https://twitter.com/pepetd3d" title="Twitter">
          <i class="fa fa-twitter" aria-hidden="true"></i>
        </a>
      </li>
    
    
      <li class="SocialNav-item">
        <a class="SocialNav-link" href="https://github.com/pepetd" title="GitHub">
          <i class="fa fa-github-alt" aria-hidden="true"></i>
        </a>
      </li>
    
    
      <li class="SocialNav-item">
        <a class="SocialNav-link" href="https://www.youtube.com/user/TheDragoon" title="YouTube">
          <i class="fa fa-youtube-play" aria-hidden="true"></i>
        </a>
      </li>
    
    
      <li class="SocialNav-item">
        <a class="SocialNav-link" href="https://vimeo.com/pepetd" title="Vimeo">
          <i class="fa fa-vimeo" aria-hidden="true"></i>
        </a>
      </li>
    
    
    
      <li class="SocialNav-item">
        <a class="SocialNav-link" href="http://www.linkedin.com/in/pepetd" title="LinkedIn">
          <i class="fa fa-linkedin" aria-hidden="true"></i>
        </a>
      </li>
    
    
      <li class="SocialNav-item">
        <a class="SocialNav-link" href="mailto:felipe@felipenogueira3d.com" title="Email">
          <i class="fa fa-envelope" aria-hidden="true"></i>
        </a>
      </li>
    
  </ul>
</div>

    </div>
  </div>


<div role="main">
  <div class="layout-widthDefault">
    <h1 class="Title u-mt16 u-mb0"><span class="Title-text">Find Verts Weighted to Bone Function</span></h1>

<ul class="MetaData">
  <li class="MetaData-item">
    <i class="fa fa-calendar-o" aria-hidden="true"></i>
    <span>March 23, 2015</span>
  </li>
  <li class="MetaData-item">
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>
    <span>
  
  
  
  <a href="/categories/tutorials">tutorials</a>
</span>
  </li>
  <li class="MetaData-item">
    <i class="fa fa-tags" aria-hidden="true"></i>
    <span>
  
  
  
  <a href="/tags/3dsmax">3dsmax</a>, <a href="/tags/maxscripts">maxscripts</a>, <a href="/tags/scripts">scripts</a>
</span>
  </li>
  <li class="MetaData-item">
    <i class="fa fa-clock-o" aria-hidden="true"></i>
    <span>2 min read</span>
  </li>
</ul>

<div class="markdown-text u-mt16">
  <p>Here is a little function I wrote that will go through all selected meshes and find all the vertices weighted to a given bone. I had to write this to find all the meshes that had a specific bone in their skin mod, but not just that! I needed to know which of those meshes had verts weighted to this specific bone.</p>

<p>The main task was to remove the influence of that bone from all meshes not necessarily remove the bone as the engine export strips out any bone that has no vertices weighted to it.</p>

<p>There are also ways to get the influenced verts of selected bone by hand, but I needed a way to go through hundreds to thousands of meshes in a timely manner.</p>

<iframe src="https://player.vimeo.com/video/60972226" width="640" height="400" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
fn findWeightedVertsFn theBone =
(
    max modify mode
    clearListener()
    theAr = selection as array
    for obj in theAr do
    (
        select obj
        skinMods = getclassinstances Skin target:obj
        for s = 1 to skinMods.count where skinMods.count > 0 do
        (
            skel = skinOps.getnumberbones skinMods[s]
            verts = skinOps.getNumberVertices skinMods[s]
            for x = 1 to skel do
            (
                If (skinOps.getBoneName skinMods[s] x 0) == theBone do
                (
                    skinOps.selectBone skinMods[s] x
                    skinOps.selectVerticesByBone skinMods[s]

                    selectedVerts = #()
                    for v = 1 to verts do
                    (
                        theVert = skinOps.IsVertexSelected skinMods[s] v
                        if theVert == 1 do append selectedVerts v
                    )

                    if selectedVerts.count > 0 do
                    (
                        print (obj.name + " has " + (selectedVerts.count as string) + " verts weighted to " + theBone)
                    )
                )
            )
        )
    )
    clearselection()
)

/*
findWeightedVertsFn "The Bone Name"
*/

</div>

<div class="disqus-comments u-mt16">
  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'disqus_short_name';
    var disqus_identifier = 'https:\/\/kstdnr.github.io\/posts\/find-verts-weighted-to-bone-function\/';
    var disqus_title = 'Find Verts Weighted to Bone Function';
    var disqus_url = 'https:\/\/kstdnr.github.io\/posts\/find-verts-weighted-to-bone-function\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
  </div>
</div>

  <div class="Footer" role="contentinfo">
    <div class="layout-widthDefault">
      <div class="Footer-inner u-mt16 u-mb16">
        <ul class="Footer-links" role="navigation" aria-label="footer navigation">
          <li class="Footer-item">
            <a class="Footer-link" href="https://kstdnr.github.io/index.xml" title="RSS"><i class="fa fa-rss" aria-hidden="true"></i></a>
          </li>
          <li class="Footer-item">
            <a class="Footer-link" href="/posts" title="Posts"><i class="fa fa-archive" aria-hidden="true"></i></a>
          </li>
        </ul>
        <span class="Footer-copy">Copyright &copy; 2017 by felipenogueira3d.com, All Rights Reserved.</span>
      </div>
    </div>
  </div>
  <script src="https://kstdnr.github.io/assets/vendor.bundle.js"></script>
  <script src="https://kstdnr.github.io/assets/main.bundle.js"></script>
</body>
</html>